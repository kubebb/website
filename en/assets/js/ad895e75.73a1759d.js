"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4288],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>f});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var o=a.createContext({}),u=function(e){var n=a.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},c=function(e){var n=u(e.components);return a.createElement(o.Provider,{value:n},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,l=e.originalType,o=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(t),d=r,f=p["".concat(o,".").concat(d)]||p[d]||m[d]||l;return t?a.createElement(f,i(i({ref:n},c),{},{components:t})):a.createElement(f,i({ref:n},c))}));function f(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var l=t.length,i=new Array(l);i[0]=d;var s={};for(var o in n)hasOwnProperty.call(n,o)&&(s[o]=n[o]);s.originalType=e,s[p]="string"==typeof e?e:r,i[1]=s;for(var u=2;u<l;u++)i[u]=t[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},3581:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>m,frontMatter:()=>l,metadata:()=>s,toc:()=>u});var a=t(7462),r=(t(7294),t(3905));const l={sidebar_position:13,title:"\u5e38\u89c1\u95ee\u9898",sidebar_label:"\u5e38\u89c1\u95ee\u9898"},i="\u5e38\u89c1\u95ee\u9898",s={unversionedId:"FAQ",id:"FAQ",title:"\u5e38\u89c1\u95ee\u9898",description:"BuildingBase\u76f8\u5173",source:"@site/docs/FAQ.md",sourceDirName:".",slug:"/FAQ",permalink:"/website/en/docs/FAQ",draft:!1,tags:[],version:"current",sidebarPosition:13,frontMatter:{sidebar_position:13,title:"\u5e38\u89c1\u95ee\u9898",sidebar_label:"\u5e38\u89c1\u95ee\u9898"},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528 kubelogin \u5de5\u5177",permalink:"/website/en/docs/develop-guid/component-market/kubelogin"},next:{title:"\u8d21\u732e\u6307\u5357",permalink:"/website/en/docs/contribute"}},o={},u=[{value:"BuildingBase\u76f8\u5173",id:"buildingbase\u76f8\u5173",level:2},{value:"\u90e8\u7f72\u95ee\u9898",id:"\u90e8\u7f72\u95ee\u9898",level:3},{value:"1. \u79df\u6237\u7ba1\u7406\u63a7\u5236\u5668probe liveness\u6821\u9a8c\u5931\u8d25\uff0c\u5bfc\u81f4\u65e0\u6cd5\u542f\u52a8",id:"1-\u79df\u6237\u7ba1\u7406\u63a7\u5236\u5668probe-liveness\u6821\u9a8c\u5931\u8d25\u5bfc\u81f4\u65e0\u6cd5\u542f\u52a8",level:4},{value:"\u95ee\u9898\u91cd\u73b0",id:"\u95ee\u9898\u91cd\u73b0",level:4},{value:"\u95ee\u9898\u539f\u56e0",id:"\u95ee\u9898\u539f\u56e0",level:4},{value:"\u89e3\u51b3\u65b9\u6848",id:"\u89e3\u51b3\u65b9\u6848",level:4}],c={toc:u},p="wrapper";function m(e){let{components:n,...t}=e;return(0,r.kt)(p,(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"\u5e38\u89c1\u95ee\u9898"},"\u5e38\u89c1\u95ee\u9898"),(0,r.kt)("h2",{id:"buildingbase\u76f8\u5173"},"BuildingBase\u76f8\u5173"),(0,r.kt)("h3",{id:"\u90e8\u7f72\u95ee\u9898"},"\u90e8\u7f72\u95ee\u9898"),(0,r.kt)("h4",{id:"1-\u79df\u6237\u7ba1\u7406\u63a7\u5236\u5668probe-liveness\u6821\u9a8c\u5931\u8d25\u5bfc\u81f4\u65e0\u6cd5\u542f\u52a8"},"1. \u79df\u6237\u7ba1\u7406\u63a7\u5236\u5668probe liveness\u6821\u9a8c\u5931\u8d25\uff0c\u5bfc\u81f4\u65e0\u6cd5\u542f\u52a8"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u73af\u5883",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Azure VM (Ubuntu 22.04)")))),(0,r.kt)("h4",{id:"\u95ee\u9898\u91cd\u73b0"},"\u95ee\u9898\u91cd\u73b0"),(0,r.kt)("p",null,"\u8fd0\u884c",(0,r.kt)("inlineCode",{parentName:"p"},"helm install --wait -n u4a-system u4a-component ."),"\u540e\uff0c\u53d1\u73b0\u79df\u6237\u7ba1\u7406\u63a7\u5236\u5668\u4e00\u76f4\u5904\u4e8e",(0,r.kt)("inlineCode",{parentName:"p"},"CrashLoopBackOff"),"\u72b6\u6001:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"\u279c  ~ k get pods -nu4a-system\nNAME                                                          READY   STATUS             RESTARTS      AGE\nbff-server-9cc54cbc5-gcp6x                                    1/1     Running            0             17m\ncapsule-controller-manager-5b9864f9bf-7mkhb                   0/1     CrashLoopBackOff   8 (27s ago)   17m\ncert-manager-79d7998d9-c7q8n                                  1/1     Running            0             33m\ncert-manager-cainjector-57bb7f44dd-c9sj6                      1/1     Running            0             33m\ncert-manager-webhook-65b494ccf4-4blzx                         1/1     Running            0             33m\ncluster-component-ingress-nginx-controller-86d6bfdbf6-qj6hf   1/1     Running            0             33m\nkube-oidc-proxy-fc6b54b8c-ddc2s                               1/1     Running            0             17m\noidc-server-84cbfcc9f5-bmmf9                                  2/2     Running            0             17m\nresource-view-controller-94645667-ttvst                       1/1     Running            0             17m\n")),(0,r.kt)("p",null,"\u67e5\u770b\u65e5\u5fd7\u53d1\u73b0\u5982\u4e0b\u9519\u8bef\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'Events:\n  Type     Reason     Age                    From               Message\n  ----     ------     ----                   ----               -------\n  Normal   Scheduled  4m35s                  default-scheduler  Successfully assigned u4a-system/capsule-controller-manager-5b9864f9bf-7mkhb to kubebb-core-worker\n  Normal   Pulling    4m34s                  kubelet            Pulling image "hub.tenxcloud.com/u4a-component/capsule:v0.1.2-20221122"\n  Normal   Pulled     3m57s                  kubelet            Successfully pulled image "hub.tenxcloud.com/u4a-component/capsule:v0.1.2-20221122" in 36.616134797s\n  Warning  Unhealthy  3m53s                  kubelet            Liveness probe failed: Get "http://10.244.1.6:10080/healthz": context deadline exceeded (Client.Timeout exceeded while awaiting headers)\n  Warning  Unhealthy  3m44s                  kubelet            Readiness probe failed: Get "http://10.244.1.6:10080/readyz": dial tcp 10.244.1.6:10080: connect: connection refused\n  Warning  Unhealthy  3m44s                  kubelet            Liveness probe failed: Get "http://10.244.1.6:10080/healthz": dial tcp 10.244.1.6:10080: connect: connection refused\n  Normal   Created    3m34s (x3 over 3m57s)  kubelet            Created container manager\n  Normal   Started    3m34s (x3 over 3m57s)  kubelet            Started container manager\n  Warning  Unhealthy  3m31s (x7 over 3m55s)  kubelet            Readiness probe failed: Get "http://10.244.1.6:10080/readyz": context deadline exceeded (Client.Timeout exceeded while awaiting headers)\n  Warning  BackOff    3m13s (x4 over 3m42s)  kubelet            Back-off restarting failed container\n  Normal   Pulled     3m1s (x3 over 3m50s)   kubelet            Container image "hub.tenxcloud.com/u4a-component/capsule:v0.1.2-20221122" already present on machine\n')),(0,r.kt)("h4",{id:"\u95ee\u9898\u539f\u56e0"},"\u95ee\u9898\u539f\u56e0"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u611f\u8c22 @0xff-dev \u63d0\u4f9b\u7684\u89e3\u51b3\u65b9\u6848")),(0,r.kt)("p",null,"\u53bb\u9664liveness probe\u540e\uff0c\u80fd\u770b\u5230\u5bb9\u5668\u62a5\u9519\uff0c\u53d1\u73b0\u662f\u7531\u4e8ecapsule\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u8d85\u51fa\u4e86\u64cd\u4f5c\u7cfb\u7edf\u5141\u8bb8\u7684\u6700\u5927\u6587\u4ef6\u6253\u5f00\u6570\uff0c\u5bfc\u81f4capsule\u65e0\u6cd5\u542f\u52a8\u3002"),(0,r.kt)("h4",{id:"\u89e3\u51b3\u65b9\u6848"},"\u89e3\u51b3\u65b9\u6848"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u611f\u8c22 @0xff-dev \u63d0\u4f9b\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u9700\u8bbe\u7f6e fs.inotify.max_user_instances=81920")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7531\u5fae\u8f6f\u7684New Bing\u89e3\u7b54\u5f97\u5230\u7684\u7b54\u6848\uff1a")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"fs.inotify.max_user_instances")," \u662f\u4e00\u4e2a\u5185\u6838\u53c2\u6570\uff0c\u5b83\u8868\u793a\u6bcf\u4e2a\u7528\u6237\u53ef\u4ee5\u521b\u5efa\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"inotify")," \u5b9e\u4f8b\u7684\u6700\u5927\u6570\u91cf\u3002",(0,r.kt)("inlineCode",{parentName:"p"},"inotify")," \u662f\u4e00\u4e2a\u7528\u6765\u76d1\u89c6\u6587\u4ef6\u7cfb\u7edf\u53d8\u5316\u7684\u673a\u5236\u3002\u5982\u679c\u4f60\u60f3\u8981\u4fee\u6539\u8fd9\u4e2a\u53c2\u6570\uff0c\u4f60\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u4e34\u65f6\u4fee\u6539\uff1a\u4f60\u53ef\u4ee5\u4f7f\u7528 sysctl -w \u547d\u4ee4\u6765\u4e34\u65f6\u4fee\u6539\u8fd9\u4e2a\u53c2\u6570\uff0c\u4f8b\u5982\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"sudo sysctl -w fs.inotify.max_user_instances=81920\n")),(0,r.kt)("p",null,"\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u628a ",(0,r.kt)("inlineCode",{parentName:"p"},"fs.inotify.max_user_instances")," \u7684\u503c\u8bbe\u7f6e\u4e3a 81920\uff0c\u5e76\u5199\u5165",(0,r.kt)("inlineCode",{parentName:"p"},"/proc/sys/fs/inotify/max_user_instances")," \u6587\u4ef6\u3002\u4f46\u662f\u8fd9\u4e2a\u4fee\u6539\u53ea\u5728\u91cd\u542f\u4e4b\u524d\u6709\u6548\uff0c\u91cd\u542f\u540e\u4f1a\u6062\u590d\u9ed8\u8ba4\u503c\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u6c38\u4e45\u4fee\u6539\uff1a\u4f60\u53ef\u4ee5\u5728 /etc/sysctl.conf \u6587\u4ef6\u4e2d\u6dfb\u52a0\u4e00\u884c\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"fs.inotify.max_user_instances=81920\n")),(0,r.kt)("p",null,"\u7136\u540e\u8fd0\u884c ",(0,r.kt)("inlineCode",{parentName:"p"},"sudo sysctl -p"),"\u547d\u4ee4\u6765\u52a0\u8f7d\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u7684\u8bbe\u7f6e\u3002\u8fd9\u6837\uff0c\u8fd9\u4e2a\u4fee\u6539\u5c31\u4f1a\u5728\u6bcf\u6b21\u91cd\u542f\u540e\u751f\u6548\u3002"),(0,r.kt)("p",null,"\u5982\u679c\u4f60\u60f3\u4e86\u89e3\u66f4\u591a\u5173\u4e8e sysctl \u548c fs.inotify.max_user_instances \u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u8003\u4ee5\u4e0b\u94fe\u63a5\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.suse.com/support/kb/doc/?id=000020048"},"How to increase the inotify.max_user_watches and inotify.max_user_instances sysctls on a Linux host | Support | SUSE")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://unix.stackexchange.com/questions/444998/how-to-set-and-understand-fs-notify-max-user-watches"},"How to set and understand fs.notify.max_user_watches - Unix & Linux Stack Exchange")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://askubuntu.com/questions/1068168/sysctl-permission-denied-on-key-fs-inotify-max-user-watches"},"sysctl: permission denied on key 'fs.inotify.max_user_watches' - Ask Ubuntu"))))}m.isMDXComponent=!0}}]);